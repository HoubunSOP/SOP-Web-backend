## 前言

此为芳文观星台的新版官网的后端程序

请注意此仓库并不稳定，如果有任何bug请开issue或者在本群中留言

## 如何运行

请注意，此仓库是必须要有mysql才能运行的，无论您是使用的远程服务器mysql或者是本机的mysql

都需要从`database sample`文件夹中运行`install.sql`来初始化数据库

然后将数据库的相关信息填写进`config.yml`

（当前的配置文件是一个局域网中的mysql数据库，您无法直接拿来使用）

## API文档

[Apifox](https://apifox.com/apidoc/shared-dabc69fb-b919-4c52-9d63-0ad3476d46b7)

如果您在本地中运行，也可以打开[本地文档](http://127.0.0.1:8000/docs)

## 数据表内容


### 表格1: comics

| 字段名   | 类型         | 是否为空 | 自增 | 注释                       |
| -------- | ------------ | -------- | ---- | -------------------------- |
| id       | INT          | 否       | 是   | 漫画唯一标识               |
| name     | VARCHAR(255) | 否       | 否   | 漫画名称                   |
| date     | DATE         | 否       | 否   | 漫画发布日期               |
| intro    | TEXT         | 是       | 否   | 漫画简介，支持Markdown语法 |
| cover    | VARCHAR(255) | 否       | 否   | 封面图片文件名             |
| magazine | VARCHAR(255) | 是       | 否   | 所属刊物。例如："刊物1"    |
| 主键     | id           |          |      |                            |
| 外键     |              |          |      |                            |

### 表格2: categories

| 字段名   | 类型         | 是否为空 | 自增 | 注释          |
| -------- | ------------ | -------- | ---- | ------------- |
| id       | INT          | 否       | 是   | 分类唯一标识  |
| name     | VARCHAR(255) | 否       | 否   | 分类名称      |
| category | VARCHAR(255) | 否       | 否   | 漫画/文章分类 |
| 主键     | id           |          |      |               |
| 外键     |              |          |      |               |

### 表格3: tags

| 字段名 | 类型         | 是否为空 | 自增 | 注释          |
| ------ | ------------ | -------- | ---- | ------------- |
| id     | INT          | 否       | 是   | 标签唯一标识  |
| name   | VARCHAR(255) | 否       | 否   | 标签名称      |
| tag    | VARCHAR(255) | 否       | 否   | 漫画/文章标签 |
| 主键   | id           |          |      |               |
| 外键   |              |          |      |               |

### 表格4: comic_category_map

| 字段名      | 类型                    | 是否为空 | 自增 | 注释                         |
| ----------- | ----------------------- | -------- | ---- | ---------------------------- |
| comic_id    | INT                     | 否       | 否   | 漫画唯一标识                 |
| category_id | INT                     | 否       | 否   | 分类唯一标识                 |
| 主键        | (comic_id, category_id) |          |      |                              |
| 外键        | comic_id                |          |      | 关联 comics 表的 id 字段     |
| 外键        | category_id             |          |      | 关联 categories 表的 id 字段 |

### 表格5: comic_tag_map

| 字段名   | 类型               | 是否为空 | 自增 | 注释                     |
| -------- | ------------------ | -------- | ---- | ------------------------ |
| comic_id | INT                | 否       | 否   | 漫画唯一标识             |
| tag_id   | INT                | 否       | 否   | 标签唯一标识             |
| 主键     | (comic_id, tag_id) |          |      |                          |
| 外键     | comic_id           |          |      | 关联 comics 表的 id 字段 |
| 外键     | tag_id             |          |      | 关联 tags 表的 id 字段   |

### 表格6: articles

| 字段名  | 类型         | 是否为空 | 自增 | 注释                       |
| ------- | ------------ | -------- | ---- | -------------------------- |
| id      | INT          | 否       | 是   | 文章唯一标识               |
| title   | VARCHAR(255) | 否       | 否   | 文章标题                   |
| date    | DATE         | 否       | 否   | 文章发布日期               |
| content | TEXT         | 是       | 否   | 文章内容，支持Markdown语法 |
| cover   | VARCHAR(255) | 是       | 否   | 文章封面                   |
| comic   | VARCHAR(255) | 是       | 否   | 关联漫画                   |
| 主键    | id           |          |      |                            |
| 外键    |              |          |      |                            |

### 表格7: article_category_map

| 字段名      | 类型                      | 是否为空 | 自增 | 注释                         |
| ----------- | ------------------------- | -------- | ---- | ---------------------------- |
| article_id  | INT                       | 否       | 否   | 文章唯一标识                 |
| category_id | INT                       | 否       | 否   | 分类唯一标识                 |
| 主键        | (article_id, category_id) |          |      |                              |
| 外键        | article_id                |          |      | 关联 articles 表的 id 字段   |
| 外键        | category_id               |          |      | 关联 categories 表的 id 字段 |

### 表格8: article_tag_map

| 字段名     | 类型                 | 是否为空 | 自增 | 注释                       |
| ---------- | -------------------- | -------- | ---- | -------------------------- |
| article_id | INT                  | 否       | 否   | 文章唯一标识               |
| tag_id     | INT                  | 否       | 否   | 标签唯一标识               |
| 主键       | (article_id, tag_id) |          |      |                            |
| 外键       | article_id           |          |      | 关联 articles 表的 id 字段 |
| 外键       | tag_id               |          |      | 关联 tags 表的 id 字段     |
